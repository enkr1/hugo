{{ define "body-class" }}template-updated{{ end }}
{{ define "main" }}
    {{ $pages := where .Site.RegularPages "Type" "in" .Site.Params.mainSections }}
    {{ $filtered := where $pages "Params.hidden" "!=" true }}
    {{ $sorted := sort $filtered ".Lastmod" "desc" }}

    <header class="section-header--grouped">
        <h1 class="section-title">{{ .Title }} · {{ len $filtered }}</h1>
    </header>

    <section class="article-list">
        {{ range $sorted }}
            <article class="article-card">
                <a href="{{ .RelPermalink }}" class="article-card__link" aria-label="{{ .Title }}"></a>

                <div class="article-details">
                    <h2 class="article-title">
                        <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                    </h2>

                    {{ with .Params.description }}
                    <h3 class="article-subtitle">{{ . }}</h3>
                    {{ end }}

                    <footer class="article-time">
                        <div>
                            {{ partial "helper/icon" "date" }}
                            <time class="article-time--updated" datetime='{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}'>
                                Updated: {{ .Lastmod | time.Format (or .Site.Params.dateFormat.lastUpdated "Jan 02, 2006 · 3:04 PM") }}
                            </time>
                        </div>

                        <div class="article-tags">
                            {{ range (.GetTerms "tags") }}<a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a>{{ end }}
                        </div>
                    </footer>
                </div>
            </article>
        {{ end }}
    </section>

    {{ partialCached "footer/footer" . }}
{{ end }}

{{ define "right-sidebar" }}
    {{ partial "sidebar/right.html" (dict "Context" . "Scope" "homepage") }}
{{ end }}
